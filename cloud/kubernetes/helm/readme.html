<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Fraud Detection FTL - TIBCO BusinessEvents&reg;
	Examples</title>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-1" />
<meta http-equiv="Content-Language" content="en-us" />
<link rel="Shortcut Icon"
	href="../../../examples/_resources/icon.gif" type="image/gif" />
<style type="text/css" media="all">
@import "../../../examples/_resources/examples.css";
</style>
<script type="text/javascript"
	src="../../../examples/_resources/examples.js" />
</script>
<script type="text/javascript">
	SendEventForm.onSubmit = function(form) {
		var serverUrl = document.getElementById("serverurl").value;
		form.setAttribute("action", serverUrl + form.getElementsByClassName("sendEventFormDestination")[0].innerHTML);
		// Prevents caching.
		var ridName = "_httprequestid_";
		var ridNode = form.elements[ridName];
		if (ridNode) {
		} else {
			ridNode = document.createElement('input');
			ridNode.setAttribute("type", "hidden");
			ridNode.setAttribute("name", ridName);
			form.appendChild(ridNode);
		}
		ridNode.value = new Date().getTime();
	}

	function buildForms() {
		var form;
		SendEventForm.setServer("");

		form = SendEventForm.get("createAccountForm");
		form.setDestinationPath("/Channels/HTTP/AllOps");
		form.setEventPath("/Events/CreateAccount");
		form.addProperty("AccountId", "Bob");
		form.addProperty("Balance", "20000");
		form.addProperty("AvgMonthlyBalance", "11000");
		form.build();

		form = SendEventForm.get("debitAccountForm");
		form.setDestinationPath("/Channels/HTTP/AllOps");
		form.setEventPath("/Events/Debit");
		form.addProperty("AccountId", "Bob");
		form.addProperty("Amount", "2000");
		form.build();

	}
</script>
</head>
<body onLoad="buildForms()">

	<h1>Fraud Detection Cache</h1>

	<h2>Purpose of This Example</h2>

	<p>This example builds on the Fraud Detection example. The Fraud Detection with Cache example adds caching and multi-engine features.
	Fraud Detection is a commonly used scenario for highlighting what's different about CEP because it shows how the CEP engine correlates different events using a time window or other criteria. In this example, fraud is suspected when either of the following occurs:</p>
	<ul>
	<li>The account incurs more than three debit transactions in a two minute period.</li>
	<li>The sum of the debits that occurs in a two minute period totals more than 80% of the average monthly balance of the account. </li>
	</ul>

	<h1>Fraud Detection Cache with FTL Cluster</h1>

	<h2>Purpose of This Example</h2>

	<p>This example builds on the Fraud Detection Cache example. The Fraud Detection Cache with FTL example adds caching and multi-engine features using FTL as a cluster provider.
	Fraud Detection is a commonly used scenario for highlighting what's different about CEP because it shows how the CEP engine correlates different events using a time window or other criteria. In this example, fraud is suspected when either of the following occurs:</p>
	<ul>
	<li>The account incurs more than three debit transactions in a two minute period.</li>
	<li>The sum of the debits that occurs in a two minute period totals more than 80% of the average monthly balance of the account. </li>
	</ul>


	<h2>How to Start the pre-requisite FTL server</h2>

	<p>This example comes with a sample FTL realm configuration (cepftlrealm.json) and a startup YAML script (cepftlcluster_persistence.yaml). 

	Fraud Detection is a commonly used scenario for highlighting what's different about CEP because it shows how the CEP engine correlates different events using a time window or other criteria. In this example, fraud is suspected when either of the following occurs:</p>
	<ul>
	<li>Please make sure you have TIBCO FTL installed at the appropriate location a.k.a. FTL_HOME, and your path includes "FTL_HOME/bin".</li>
	<li>Open cepftlcluster_persistence.yaml and substitute your actual value for <i>BE_HOME</i>.</li>
	<li>Execute the following on the command prompt.</li>
	<pre class="commands">
	cd <i>BE_HOME</i>/examples/standard/FraudDetectionFTL
	tibftlserver -n ftlserver1 -c cepftlcluster_persistence.yaml
	tibftladmin -ur cepftlrealm.json -rs http://localhost:8585
	</pre>
	<li>Please make sure deployment is completed successfully in FTL server log.</li>
	<li>Edit be-engine.tra to set FTL_HOME appropriately.</li>
	<li>Finally ensure CDD is configured properly with FTL cluster configuration.</li>
	</ul>


	<h1>How to Run the Example</h1>
	<ol>
		<li>Get External IP and port for befdservice from Kubernetes and
			set server url.<br />  <b>Server URL:</b> <input type="text" id="serverurl" value="http://localhost:8209" style="height: 30px;width:100%">
				
		</li>
		<li>Submit the forms by clicking the given buttons</li>

		<li>
			<p>Create an account and give it a balance and an average monthly
				balance. Enter a name in the Account ID field. Enter, for example,
				10000 in the Balance, and 20000 in the AvgMonthlyBalance fields.
				Repeat this step to create multiple accounts, as desired.</p> Host:

			<form id="createAccountForm"></form>

			<p>
				In the command window you see a message like this: <span
					class="logs">#### Created account Bob.</span>
			</p>
		</li>


		<li>
			<p>Now debit the account. In the AccountId field, enter one of
				the account names you specified above. Enter the amount of the debit
				in the Amount field. Then click Send.</p>

			<form id="debitAccountForm"></form>

			<p>
				In the command window you see messages like this (the actual message
				depends on the account balance, the average monthly balance, and
				other events that happened in the two minute window): <span
					class="logs">#### Debiting account Bob by $1000.0</span>
			</p>
		</li>


		<li>
			<p>Rules in the project react to various inputs depending on
				current facts in the Rete network. You can try the following.</p>

			<table>
				<tr>
					<th>Action</th>
					<th>Message</th>
				</tr>
				<tr>
					<td>In the /Events/CreateAccount form, enter the same account
						name two times.</td>
					<td><pre class="logs">#### Account already exists: Bob</pre></td>
				</tr>
				<tr>
					<td>In the /Events/Debit form, enter a debit amount greater
						than the account balance.</td>
					<td><pre class="logs">#### Account ID Bob STATUS set to Suspended. <br>Balance -1000.0 is less than zero
								
						</pre></td>
				</tr>
				<tr>
					<td>In the Events/Debit form, debit an account that was set to
						Suspended.</td>
					<td><pre class="logs">#### Cannot debit the suspended account Bob</pre></td>
				</tr>
				<tr>
					<td>In the Events/Debit form, match the fraud detection
						criteria to meet both of the following conditions:
						<ul>
							<li>Make 3 debits within 2 minutes</li>
							<li>Make debits such that the sum of the debits occurring in
								a two minute period totals more than 80% of the average monthly
								balance of the account.</li>
						</ul>
					</td>
					<td><pre class="logs">#### Account ID Bob STATUS set to Suspended. <br>Fraud suspected
								
						</pre></td>
				</tr>
			</table>
		</li>

		<li>
			<p>To reset the data, restart the engine at the command line.</p>
		</li>

	</ol>



	<div class="footer">
<p>TIBCO BusinessEvents&reg; 6.0<br />
Copyright&copy; 2004-2020 TIBCO Software Inc. All rights reserved.</p>
</div>
</body>
</html>
